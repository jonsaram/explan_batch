<meta charset="utf-8">
<script type="text/javascript">
	var <@popupId> = {
		 rcvData 		: {}
 		,returnData 	: {}
	 	,BUYER_CONSULTING_LIST : []
	 	,SELECTED_CONSULTING : {}
	 	,CONSULTING_LST	: []
	 	,yearMonths		: [[dayjs().subtract(3, 'month').format('YYYY-MM'), dayjs().subtract(3, 'month').format('YYYY년 MM월')]
						  ,[dayjs().subtract(2, 'month').format('YYYY-MM'), dayjs().subtract(2, 'month').format('YYYY년 MM월')]
						  ,[dayjs().subtract(1, 'month').format('YYYY-MM'), dayjs().subtract(1, 'month').format('YYYY년 MM월')]
						  ,[dayjs().format('YYYY-MM'),dayjs().format('YYYY년 MM월')]  
						  ,[dayjs().add(1, 'month').format('YYYY-MM'),dayjs().add(1, 'month').format('YYYY년 MM월')]
						  ]
		,close : function(returnData) {
			
			if(isEmpty(returnData)) returnData = {};
			C_POP.close(returnData);
		 }
		,pageInit : () =>{
			
			var dateList = { data	: <@popupId>.yearMonths,targetId : "<@popupId>_yearMonths"	}
			C_UICOM.makeSelectBox(dateList, "single");
			C_UICOM.setSingleBox("<@popupId>_yearMonths", dayjs().year()+"-"+("0"+(dayjs().month() + 1) ).slice(-2));
			C_UICOM.setSelectBoxOption("<@popupId>_yearMonths", "readOnly", "Y");
			
			$("#<@popupId>_reporter").text(<@popupId>.rcvData.param.REPORTER_NM);
			$("#<@popupId>_buyerNm").text(<@popupId>.rcvData.param.BUYER_NM);
			
			const parm = {
					 queryId 		: "custDashboard.getConsultingList"
					,requestParm	: 
									{
										BUYER_ID		: <@popupId>.rcvData.param.BUYER_ID
										/* ,MODE			: "<@mode>" */
									}
			}
	
			C_COM.requestQuery(parm, function(resultData) {
				
				<@popupId>.BUYER_CONSULTING_LIST = resultData.data;
				
				<@popupId>.SELECTED_CONSULTING	 =<@popupId>.BUYER_CONSULTING_LIST[0];  

				let consultinglist = <@popupId>.BUYER_CONSULTING_LIST.map( item =>{
					return [item.CONSULTING_ID, item.CONSULTING_NM]
					
				})
				<@popupId>.CONSULTING_LST = consultinglist;

				var dateList = { data	:consultinglist , targetId : "<@popupId>_consultingNms"	}
				C_UICOM.makeSelectBox(dateList, "single");
				C_UICOM.setSingleBox("<@popupId>_consultingNms", <@popupId>.rcvData.param.CONSULTING_ID);
				C_UICOM.setSelectBoxOption("<@popupId>_consultingNms", "readOnly", "Y");

				
				$("#<@popupId>_content").val(<@popupId>.rcvData.param.CONTENT).prop('disabled',true);
							
			});
		}
		,consultingNmsChange : (obj) =>{
			const CONSULTING_ID = C_UICOM.getData("<@popupId>_consultingNms");
			<@popupId>.SELECTED_CONSULTING = <@popupId>.BUYER_CONSULTING_LIST.find( item => item['CONSULTING_ID'] == CONSULTING_ID);
		}
		,fileAttach : () => {
			
			var parm = {
					 	GRP_FILE_ID 	: <@popupId>.BUYER_CONSULTING_ID
						,OWNER_CD 		: "APPROVAL"
						,mode			: "R"
					 
			}
			C_COMP.import("<@popupId>_importMultiFilemng", "component_compMultiFilemng", parm , function() {
				
			});
	
			$("#<@popupId><@popupId>_importMultiFilemng #title").remove();			
			
		}
	}
	// Popup Load가 완료된후 실행 된다.
	C_POP.onLoadPopup("<@popupId>", function(data) {
		
		<@popupId>.rcvData = data;
		<@popupId>.BUYER_CONSULTING_ID = isEmpty(<@popupId>.rcvData?.param?.BUYER_CONSULTING_ID) ?  C_COM.makeUniqueId()
										: <@popupId>.rcvData?.param?.BUYER_CONSULTING_ID ;
		<@popupId>.pageInit();
		
		setTimeout(()=>{
			<@popupId>.fileAttach();
		},100);
	});
</script>
  <!-- modal-popup start -->
  <div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <!-- header start -->
        <div class="modal-header srch-pop-inwrap">
          <h5 class="modal-title col9 col8-md col7-sm" id="exampleModalLongTitle">기업자문보고서</h5>
          <!-- button start -->
          <div class="txt-r col1 col2-md col3-sm">
            <button type="button" class="win-fullcls" onclick="C_POP.normalSize('<@popupId>')">
            </button>
            <!-- <button type="button" class="win-full" onclick="C_POP.fullSize('<@popupId>')"> -->
            <button type="button" class="win-full" onclick="C_POP.maxSize('<@popupId>')">
            
            </button>
            <button type="button" class="close" aria-label="Close" onclick="<@popupId>.close()">
              <span class="pop-cls" aria-hidden="true"></span>
            </button>
          </div>
          <!-- button end -->
        </div>
        <!-- header end -->
        <div class="modal-body">                            
			<div class="pop_tab_content_box fx-col2 fx-col2-md">
				<div class="col10 col10-md col10-sm">
					<div class="tab-card-outline">
					<!-- table start -->
					<table class="card-view-tb01">
					    <colgroup>
					        <col width="18%">
					        <col width="*">
					        <col width="18%">
					        <col width="*">                                                                               
					    </colgroup>
						<tbody>
				        	<tr>
					            <th>회사명</th>
					            <td id="<@popupId>_buyerNm">(주)이데인홀딩스</td>
					            <th>보고년월</th>
					            <td><select class="form-control form-control-sm col10" id="<@popupId>_yearMonths"></select></td>                                                                              
				        	</tr> 
				        	<tr>
						        <th>상품명</th>
						        <td><select class="form-control form-control-sm col10" id="<@popupId>_consultingNms" onChange="<@popupId>.consultingNmsChange(this)"></select></td>
						        <th>보고자</th>
						        <td class="tl" id="<@popupId>_reporter"></td>                                                                              
						    </tr> 
<!-- 						    <tr>
						        <th>보고내용</th>
						        <td colspan="3"><textarea class="col10" rows="12" id="<@popupId>_content"></textarea></td>                                                                            
						    </tr>  -->
						    <tr>
						        <th>첨부파일</th>
						        <td colspan="3" id="<@popupId>_importMultiFilemng" >첨부파일이 없습니다.</td>                                                                            
						    </tr> 
						</tbody>
					</table>
				    <!-- table end -->                            
					</div>
				</div>
	       	</div>
        <!-- footer start -->
        <div class="modal-footer">
          <button type="button" class="btn outline-btn mr20" onclick="<@popupId>.close()">Close</button>
        </div>
        <!-- footer end -->
      </div>
    </div>
  </div>                      
  <!-- modal-popup end -->