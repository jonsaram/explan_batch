<meta charset="utf-8">
<script type="text/javascript">
	var <@popupId> = {
		 sendParm			: {}
		,selectRecipeCd		: ""
		,onClickRowRecipe	: function(data) {
			<@popupId>.loadGrid2(data.RECIPE_CD);
		 }
		,loadGrid1			: function(parm, callback) {
			////////////////////// 첫번째 그리드 ////////////////////////////////////
			let sendParm = {
				gridParm : {
					 tableName		: "TBL_EXP_ROLE"
					,columnMap 		: {
						 "ROLE_ID"			: { headerText : "Role ID"		}
						,"ROLE_NM" 			: { headerText : "Role 명" 		}
						,"USE_YN" 			: { headerText : "사용여부" 	}
					 }
					,primaryKeyList		: ["USER_ID"]
					,searchColumnList	: ["USER_ID"]		// Table 지정인경우 적용
					,columnConfig 	: {
					 }
				 }
				,gridTitle : "ROLE 마스터 관리"
			}
			
			C_COMP.import("gridComp1", "component_compGridWithSearch",sendParm , function(tableList) {
				if( typeof callback == "function") callback(tableList);
			});		
			
		 }
		,loadGrid2			: function(recipeCd) {
			if(isValid(recipeCd)) <@popupId>.selectRecipeCd = recipeCd;
			
			////////////////////// 두번째 그리드 ////////////////////////////////////
			let sendParm2 = {
				gridParm : {
					 tableName		: "TBL_EXP_AUTH"
					,columnMap 		: {
						 "USER_ID"			: { headerText : "사용자ID", hidden : "Y", ifNewAutoSet : "random" 					}
						,"ROLE_ID" 			: { headerText : "권한롤ID" 													}
						,"USE_YN" 			: { headerText : "사용여부" 													}
					 }
					,primaryKeyList		: ["USER_ID"]
					,searchColumnList	: ["USER_ID"]		// Table 지정인경우 적용
					,columnConfig 	: {
					 }
				 }
				,gridTitle : "권한설정관리"
			}
			
			C_COMP.import("gridComp2", "component_compGridWithSearch",sendParm2 , function(tableList) {
				
			});		
		 }
		,loadGrid3			: function() {
			////////////////////// 세번째 그리드 ////////////////////////////////////
			let gridParm = {
				 tableName		: "TBL_EXP_FOOD_MATERIALS_MASTER"
				,columnMap 		: {
					 "MATERIALS_MASTER_ID" 			: { headerText : "MATERIALS_ID"	, hidden : "Y", ifNewAutoSet : "random"				}
					,"MATERIALS_CD"        			: { headerText : "식자재CD"  	, width	 : "120px"								}
					,"MATERIALS_NM"        			: { headerText : "식자재명"  													}
				 }
				,columnConfig 	: {
				 }
				,rowCntId			: "<@popupId>_rowCnt3"
				,primaryKeyList		: ["MATERIALS_MASTER_ID"]
				,searchColumnList	: ["MATERIALS_CD", "MATERIALS_NM"]				
				,orderColumnList 	: ["SORT_ORDER ASC"]							
				,filterWhere		: `BRAND_ID = '${G_VAL.session.BRAND_ID}'`
				,checkbox			: "show"
				//,ordernum			: "hide"
				,readOnly			: "Y"
			}

			C_COMP.import("gridComp3", "component_compGrid",{ gridParm : gridParm } , function(tableList) {
				
			});		
		 }
		,reloadGrid3 : function() {
			let searchValue = $("#<@popupId> #searchValue").val();
			<@popupId>["gridComp3"].reload({searchValue : searchValue});
		 }
		,close : function(returnData) {
			if(isEmpty(returnData)) returnData = {};
			C_POP.close(returnData);
		 }
		
	}
	// Popup Load가 완료된후 실행 된다.
	C_POP.onLoadPopup("<@popupId>", function(parm) {
		
		<@popupId>.loadGrid1(parm, function(tableList) {
			
			let recipeCd = tableList[0].RECIPE_CD;
			
			<@popupId>.loadGrid2(recipeCd);
		});
		
		<@popupId>.loadGrid3();
	});
</script>
<!-- modal-popup start -->
<div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
    <div class="full-modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <!-- header start -->
        <div class="modal-header srch-pop-inwrap">
          <h5 class="modal-title col9 col8-md col7-sm">레시피 구성 편집</h5>
          <!-- button start -->
          <div class="txt-r col1 col2-md col3-sm">
            <button type="button" class="win-fullcls" style="display:none">
            </button>
            <button type="button" class="win-full" style="display:none">
            </button>
            <button type="button" class="close" aria-label="Close" onclick="<@popupId>.close()">
              <span class="pop-cls" aria-hidden="true"></span>
            </button>
          </div>
          <!-- button end -->
        </div>
        <!-- header end -->
  
        <!-- body start -->
        <div class="modal-body">
          <div class="body-inwrap display-row-nowrap-md"> <!-------------------- 테이블 좌, 우 배치 시 -- 이 부분에 클래스명 추가 ( display-row-nowrap-md ) // 테이블 하나의 경우 클래스명 추가 불필요 -------------------->

            <!-- table area start -->
            <div class="tb-card-allwrap col4 col10-md col10-sm mt10">
                <div class="card-inwrap">
                    <div id="tb-scroll" class="card-cnt-wrap">
						<!-- table start -->
						<compnent id="gridComp1"></compnent>    
						<!-- table end -->        
                    </div>
                </div>
            </div>
            <!-- table area end -->            

            <!-- table area start -->
            <div class="tb-card-allwrap col4 col10-md col10-sm mt10">
                <div class="card-inwrap">
                    <div id="tb-scroll" class="card-cnt-wrap">
						<!-- table start -->
						<compnent id="gridComp2"></compnent>    
						<!-- table end -->        
                    </div>
                </div>
            </div>
            <!-- table area end -->            

            <!-- table area start -->
            <div class="tb-card-allwrap col3 col10-md col10-sm mt10">
                <div class="card-inwrap">
                    <div id="tb-scroll" class="card-cnt-wrap">
					    <!-- table area start -->
						<div class="table-allwrap display-column"> <!-------------------- 이 부분에 클래스명 추가 ( display-column ) -------------------->
						    <div class="card-tit-wrap">
						        <div class="card-tit">식자재 선택</div>
						    </div>
						    <div class="display-between display-sm-between deco-line pt10 pl10 pr10 pb5">
						        <div class="col4-md col10-sm display-h-end mb5">
						          <span class="col2-sm w80px mb3">검색어</span>
						          <input type="text" class="form-control form-control-sm mr5 col4" id="searchValue" onEnter="<@popupId>.reloadGrid3()">
						          <button class="srch-btn" type="button" onclick="<@popupId>.reloadGrid3()">검 색</button>       
						        </div>
						        <div class="display-w-end col4 col4-md col10-sm mb5">
						          <span class="col2-sm w120px txt-r mr10">Total : <span class="txt-red" id="<@popupId>_rowCnt3"></span></span>              
						          <button class="flat-btn col2-sm" type="button" onclick="<@popupId>.addMaterialsToRecipe()">선택</button>
						        </div>
						    </div>
						    <div class="table-inwrap-scroll"> <!-------------------- 이 부분에 div + 클래스명 추가 ( table-inwrap-scroll ) -------------------->
								<!-- table start -->
								<compnent id="gridComp3"></compnent>    
								<!-- table end -->        
						    </div>
						</div>
					    <!-- table area end -->
                    </div>
                </div>
            </div>
            <!-- table area end -->            


          </div>        
        </div>
        <!-- body end -->
  
        <!-- footer start -->
        <div class="modal-footer">
          <button type="button" class="btn outline-btn mr20" onclick="<@popupId>.close()">Close</button>
        </div>
        <!-- footer end -->
      </div>
    </div>
</div>                      
  <!-- modal-popup end -->
