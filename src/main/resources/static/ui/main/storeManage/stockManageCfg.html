<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		 brandId		: G_VAL.session.BRAND_ID
		,storeId	: ""
		,loadComponent : function(selectList) {
			let sendParm = {
				gridParm : {
					 requestQuery 	: {
						  queryId		: "storeManage.getStoreManageCfg"
						 ,requestParm	: {
							 "STORE_ID" : G_VAL.current.storeId
						 }
					 }	
					,tableName		: "TBL_EXP_STOCK_STORE_CFG"
					,columnMap 		: {
						 "STOCK_STORE_CFG_ID"	: { headerText : "재고설정ID"	,hidden 	: "Y" , ifNewAutoSet : "random"	}
						,"BRAND_ID"      		: { headerText : "상품타입"		,hidden		: "Y" , default		: G_VAL.session.BRAND_ID	}
						,"STORE_ID"      		: { headerText : "가맹점ID"		,hidden		: "Y" , default		: G_VAL.current.storeId	}
						,"STOCK_MST_ID"			: { headerText : "재고마스터ID"	,hidden		: "Y"	}
						,"PRODUCT_CD"			: { headerText : "상품코드"		,noSave		: "Y"	}
						,"PRODUCT_TYPE"			: { headerText : "상품타입"		,noSave		: "Y"	}
						,"PRODUCT_NM"			: { headerText : "상품명"		,noSave		: "Y"	}
						,"UNIT"					: { headerText : "단위"			,noSave		: "Y"	}
						,"START_QUANTITY"		: { headerText : "시작수량"							}
						,"START_DATE"			: { headerText : "시작기준일", dataType : "date"	}
						,"FULL_QUANTITY"		: { headerText : "기준수량"							}
					 }
					,columnConfig 	: {
					 }
					,primaryKeyList		: ["STOCK_STORE_CFG_ID"]
					,searchColumnList	: ["PRODUCT_CD", "PRODUCT_NM"]		
					,orderColumnList 	: ["STORE_NM", "PRODUCT_CD"]
					,searchWhereMap		: {"A.BRAND_ID" : G_VAL.session.BRAND_ID }
					,useRuntimeLoad		: 100										// Scroll을 하단으로 내리면 page단위로 실시간으로 추가 Data를 가져온다. 가져오는 Page단위 
					,updateOnly			: "Y"
				 }
				,optionConfig		: {
					selectBoxForSearchConfig : {
						 title			: "가맹점"
						,whereColumn	: "B.STORE_ID"
						,targetColumn	: "STORE_NM"
						,optionList 	: selectList
						,onSelect		: function(selectVal) {
							G_VAL.current.storeId = selectVal;
						 }
					}
				 }
			}

			C_COMP.import("stockMasterGrid", "component_compTableEditor",sendParm , function(tableList) {
				if(tableList.length == 1 && isEmpty(tableList[0].STOCK_MST_ID) ) {
					// 초기 Data가 없을 경우
					let parm = {
						 queryId : "storeManage.setStockInitData"
						,requestParm : {
							 BRAND_ID : G_VAL.session.BRAND_ID
							,STORE_ID : G_VAL.current.storeId
						 }
					}
	               C_COM.requestQuery(parm, function(resultData) {
						<@pageId>["stockMasterGrid"].reload();
	               });
				}
			});		
		 }
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function(parm) {
		
		C_COM.getStoreList(G_VAL.session.BRAND_ID, function(selectList) {
			<@pageId>.loadComponent(selectList);
		});
		
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<page-component>
    <!-- table area start -->
	<compnent id="stockMasterGrid"></compnent>    
    <!-- table area end -->
</page-component>