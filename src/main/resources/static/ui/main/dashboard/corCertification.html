<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
			
	        TECHNICAL_DATA : ''
            ,pageInit : () => {
                
             }
            ,getTechnicalSkills : function() {
               
               var buyerId = G_VAL.session.BUYER_ID;
               /* 기술력 */
               let requestParm = {};
               requestParm["buyerId"]    = buyerId;
               requestParm["comCodeId"]  = "";
               requestParm["grpCodeId"]  = "TECHNICAL";
               requestParm["comCode"]    = "TECHNICAL_SKILLS_GRADE";
               
               let parm = {
                    queryId        : "dashboardCertification.getCrtInfo"
                   ,requestParm    : requestParm
               }
                
               C_COM.requestQuery(parm, function(resultData) {
                   
                   let infoData    = resultData.data[0].INFO_DATA;
                   <@pageId>.setChart( infoData );
                   
                });
            } 
            
            ,setChart : (data) =>{
                
                let dataNum = parseInt(data);
                <@pageId>.TECHNICAL_DATA = dataNum;
                
                let chartColor   = "";
                let skillGradeNm = "";
                let allGrade = 100;
                let otherGrade = 100 - dataNum;
                
                if( dataNum <= 10 ){
                    skillGradeNm = '열위';
                    chartColor   = '#dd0000';
                }else if( 10 < dataNum && dataNum <= 30 ){
                    skillGradeNm = '미흡';   
                    chartColor   = '#f07300';               
                }else if( 30 < dataNum && dataNum  <= 50 ){
                    skillGradeNm = '보통';   
                    chartColor   = '#ffd84f';                  
                }else if( 50 < dataNum && dataNum  <= 70 ){
                    skillGradeNm = '양호';   
                    chartColor   = '#32c100';                  
                }else if( 70 < dataNum && dataNum  <= 90 ){
                    skillGradeNm = '우수';   
                    chartColor   = '#00b5dd';                  
                }else if( 90 < dataNum ){
                    skillGradeNm = '최우수';
                    chartColor   = '#1000c6';
                }else{}
                
                
                $('#<@pageId>_skillGradeNm').text(skillGradeNm);
                
                $("#<@pageId>_chart").highcharts({
                    chart: {
                        plotBackgroundColor: null,
                        plotBorderWidth: 0,
                        plotShadow: false,
                        margin: [0, 0, 0, 0],
                    },
                    credits: {enabled: false},// 하이차트 워터마크 삭제
                    title: {
                        text: '',

                    },
                    tooltip: {
                        pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
                    },
                    legend: {
                        enabled: false,

                    },
                    accessibility: {
                        point: {
                            valueSuffix: '%'
                        }
                    },
                    plotOptions: {
                        pie: {
                            dataLabels: {
                                enabled: false
                            },
                            startAngle: -140,
                            endAngle: 220,
                            center: ['60%', '50%'],
                            size: '100%',
                            borderRadius: 50,
                            showInLegend: true
                        },

                    },
                    colors: [chartColor, '#FFFFFF'],
                    series: [{
                        type: 'pie',
                        name: 'Browser share',
                        innerSize: '82%',
                        data: [
                            [skillGradeNm, dataNum],
                            ['', otherGrade],
                        ]
                    }]
                });

        }//setChart11 
        ,technicalPopup : function() {

            let parm = {
                 title1 : "기술력 등록"    
                ,title2 : "기술력"
            }

            C_POP.open('popup_dashboard_technicalPopup', parm, function(retData) {
            	console.log("technicalPopup 팝업 호출 완료");
            	<@pageId>.getTechnicalSkills();
            });
        } 
        ,getCorporateCertification : function() {
        	
            /* 기업인증 */
            let certificationRequestParm = {};
            certificationRequestParm["buyerId"]    = G_VAL.session.BUYER_ID;
            certificationRequestParm["comCodeId"]  = "CORPORATE_CERTIFICATION";
            certificationRequestParm["grpCodeId"]  = "CERTIFICATION";
            certificationRequestParm["comCode"]    = "CERTIFICATION_COMPLETE";
            
            let certificationParm = {
                 queryId        : "dashboardCertification.getCrtInfo"
                ,requestParm    : certificationRequestParm
            }
            
            C_COM.requestQuery(certificationParm, function(resultData1) {
                
                let rparm = {
                         targetId   : "certificationTableId"
                        ,list       : resultData1.data
                    }
                C_COM.renderHtml("<@pageId>", rparm);
                
             }); 
        }

        ,getIndustrialProperty : function() {

            /* 산업재산권 */
            let propertyRequestParm = {};
            propertyRequestParm["buyerId"]      = G_VAL.session.BUYER_ID;
            propertyRequestParm["comCodeId"]    = "INDUSTRIAL_PROPERTY";
            propertyRequestParm["grpCodeId"]    = "INDUSTRIAL_PROPERTY";
            propertyRequestParm["comCode"]      = "";
            
            let propertyParm = {
                 queryId        : "dashboardCertification.getCrtInfo"
                ,requestParm    : propertyRequestParm
            }
            C_COM.requestQuery(propertyParm, function(resultData2) {
                
                for (var i=0; i<resultData2.data.length; i++){
                    
                    var codeId = resultData2.data[i].CODE_ID;
                    var data   = resultData2.data[i].INFO_DATA;

                    if( codeId == "PATENT" ){
                        $('#<@pageId>_patent').text(data+"건");
                    } else if( codeId == "UTILITYT_MODEL" ){
                        $('#<@pageId>_utilityt_model').text(data+"건");
                    } else if( codeId == "DESIGN" ){
                        $('#<@pageId>_design').text(data+"건");
                    } else if( codeId == "TRADEMARK" ){
                        $('#<@pageId>_trademark').text(data+"건");
                    }else{}
                 }
               
             });
            
        }
        ,industrialPropertyPopup : function() {
            console.log("industrialPropertyPopup");
            let parm = {
                 title1 : "산업재산권 등록"    
                ,title2 : "산업재산권"
            }

            C_POP.open('popup_dashboard_industrialPropertyPopup', parm, function(retData) {
                console.log("industrialPropertyPopup 팝업 호출 완료");
                <@pageId>.getIndustrialProperty();
            });
        }
        

        ,certificationPopup : function() {
            console.log("certificationPopup");
            let parm = {
                 title1 : "기업인증 등록"    
                ,title2 : "기업인증"
            }

            C_POP.open('popup_dashboard_certificationPopup', parm, function(retData) {
                console.log("certificationPopup 팝업 호출 완료");
                <@pageId>.getCorporateCertification();
            });
        }

			
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function() {

		// 상단 Title 및 메뉴 Path 처리 시작
		// 상단 Title 및 메뉴 Path 처리 시작
		// 상단 Title 및 메뉴 Path 처리 시작
		C_COMP.import("<@pageId>_breadcrumb", "component_compBreadcrumb",{} , function() {});
		
		C_COMP.import("<@pageId>_titleArea", "component_compTitleArea",{} , function() {});

		<@pageId>.pageInit();
		<@pageId>.getTechnicalSkills();
        <@pageId>.getCorporateCertification();
        <@pageId>.getIndustrialProperty();
        

	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<page-component>

	<!--  상단 Title 및 메뉴 Path 처리 시작
		  상단 Title 및 메뉴 Path 처리 시작
		  상단 Title 및 메뉴 Path 처리 시작  -->

    <!-- breadcrumb start -->
	<compnent id="<@pageId>_breadcrumb"></compnent>    
    <!-- breadcrumb end -->

    <!-- sub title + button start -->
	<compnent id="<@pageId>_titleArea"></compnent>    
    <!-- sub title + button end -->

	<!--  상단 Title 및 메뉴 Path 처리 끝
		  상단 Title 및 메뉴 Path 처리 시작
		  상단 Title 및 메뉴 Path 처리 시작  -->

<!---------------------------------- 컴포넌트 카피 + 대체 시작 영역 -------------------------------------->
     <div class="pop_tab_content_box tb-div-h04 fx-col2 fx-col2-md">
         <div class="col3 col10-md col10-sm display-column">
             <div class="display-column col10-md col10-sm tab-card-outline mb10">
                 <div class="card-tit-wrap">
                     <div class="card-tit">기술력</div>
                     <button class="msg-edit" onClick="<@pageId>.technicalPopup()"></button>
                 </div>
                 <div class="display-column-center p20">
                     <!-- chart start -->
                     <div class="cont_box">
                         <div class="piechart_wrap stateWrap">
                             <div class="state"><span class="num" id="<@pageId>_skillGradeNm"></span></div>
                         </div>
                         <figure class="clearFix">
                             <div class="chart pt10 fl" id="<@pageId>_chart"  style="width:calc(100% - 80px); max-width:calc(100% - 80px);min-width:calc(100% - 80px); height:280px; "></div>
                             <ul class="status_wrap pr50 fr" style="width:80px;">
                                 <li><i class="status veryBest"></i><span>최우수</span></li>
                                 <li><i class="status great"></i><span>우수</span></li>
                                 <li><i class="status good"></i><span>양호</span></li>
                                 <li><i class="status commonly"></i><span>보통</span></li>
                                 <li><i class="status inadequate"></i><span>미흡</span></li>
                                 <li><i class="status inferior"></i><span>열위</span></li>
                             </ul>
                         </figure>
                     </div>
                     <!-- chart end -->
                 </div>
             </div>
             <div class="display-column col10-md col10-sm tab-card-outline mb10">
                 <div class="card-tit-wrap">
                     <div class="card-tit">산업 재산권</div>
                     <button class="msg-edit" onClick="<@pageId>.industrialPropertyPopup()"></button>
                 </div>
                 <div class="display-column h100">    
                     <div class="display-row col10 h50">
                         <div class="display-column-center col5 p20 deco-line-rt">
                             <span class="fs30 txt-cyan mb10" id="<@pageId>_patent">건</span>
                             <span class="round-container01 fs-w txt-center">특허</span>
                         </div>
                         <div class="display-column-center col5 p20">
                             <span class="fs30 txt-cyan mb10" id="<@pageId>_utilityt_model">건</span>
                             <span class="round-container01 fs-w txt-center">실용신안</span>
                         </div>
                     </div>
                     <div class="display-row col10 h50">
                         <div class="display-column-center col5 p20 deco-line-rt">
                             <span class="fs30 txt-cyan mb10" id="<@pageId>_design">건</span>
                             <span class="round-container01 fs-w txt-center">디자인</span>
                         </div>
                         <div class="display-column-center col5 p20">
                             <span class="fs30 txt-cyan mb10" id="<@pageId>_trademark">건</span>
                             <span class="round-container01 fs-w txt-center">상표권</span>
                         </div>
                     </div>
                 </div>
             </div>                                   
         </div>
         <div class="col7 col10-md col10-sm">
             <div class="display-between-start col10-md col10-sm tab-card-outline mb10">
                 <div class="col10">
                     <div class="card-tit-wrap">
                         <div class="card-tit">
                             기업인증
                         </div>
                         <button class="msg-edit" onClick="<@pageId>.certificationPopup()"></button>
                     </div>
                     <div class="card-cnt-wrap">
                         <div class="display-row-nowrap-md01 tb-div-h03 p20" id="certificationTableId"></div>
                            <script type="text/x-jsrender" id="certificationTableId_template">    
                                {{for list}}
                                    <div class="mb20 p10 txt-center col2 col25-md col5-sm">
                                      {{if INFO_DATA =='COMPLETED' }}
                                          <img src="images/certification-on.png" alt="" width="130px">
                                      {{else}}
                                          <img src="images/certification-off.png" alt="" width="130px">
                                      {{/if}}
                                      <p class="fs16 fs-w txt-center mt10">{{:CODE_ID_NM}}</p>
                                    </div>  
                                {{/for}}
                            </script>
                     </div>
                 </div>
             </div>
         </div>
     </div>
<!---------------------------------- 컴포넌트 카피 + 대체 끝 영역 -------------------------------------->                

</page-component>