<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		  brandId	: G_VAL.session.BRAND_ID
		 ,loadComponent : function() {
			
			let parm = {
				  queryId 		: "common.getAllBrandList"
				 ,requestParm 	: {}
			}
			let resultData = C_COM.requestQuery(parm);
			
			let brandAllList = C_COM.makeCodeList(resultData.data, "BRAND_ID", "BRAND_NM");

			let sendParm = {
				gridParm : {
					 requestQuery : {
						  queryId 		: "system.getBrandCodeList"
						 ,requestParm 	: {}
					 }
					,columnMap 		: {
						 "BRAND_ID"    : { headerText : "BRAND_ID"	,hidden : "Y"					}
						,"GRP_CODE_ID" : { headerText : "GRP_CODE_ID", width : "250px", align:"left"}
						,"GRP_CODE_NM" : { headerText : "GRP_CODE_NM"}
						,"CODE_ID"     : { headerText : "CODE_ID"    , width : "200px", align:"left"}
						,"CODE_NM"     : { headerText : "CODE_NM"    }
						,"CODE_DESC"   : { headerText : "CODE_DESC"  }
						,"USE_YN"      : { headerText : "USE_YN"     }
						,"DEL_YN"      : { headerText : "DEL_YN"     }
						,"SORT_ORDER"  : { headerText : "SORT_ORDER" }
						,"ATTR1"       : { headerText : "ATTR1"      }
						,"ATTR2"       : { headerText : "ATTR2"      }
					 }
					,columnConfig 	: {
					 }
					,primaryKeyList		: ["GRP_CODE_ID"		,"CODE_ID"					]
					,searchColumnList	: ["A.GRP_CODE_ID"		,"CODE_ID"		,"CODE_NM"	]		// Table 지정인경우 적용
					,orderColumnList 	: ["A.GRP_CODE_ID ASC"	,"CODE_ID ASC"				]
					,cellMergeList		: [["GRP_CODE_ID"		,"GRP_CODE_NM"	, 1]		]
				 }
				,optionConfig		: {
					searchComponentList : [
						{
							 type			: "singleSelectBox"	
							,title			: "Brand ID"
							,whereColumn	: "A.BRAND_ID"
							,optionList 	: brandAllList
							,defaultVal		: <@pageId>.brandId
							,onChange		: function(selectVal, thisComp) {
								<@pageId>.brandId = selectVal;
								thisComp.reload();
							}
						}
					]
				 }		
				,callbackEditButton : function(parm) {
					<@pageId>.openEditMultiTable();
				 }
				
			}
			C_COMP.import("<@pageId>_tableGrid", "component_compTableEditor",sendParm , function() {});		
		 }
		,openEditMultiTable : function() {

			var ynCdList = C_COM.getCodeList("YES_OR_NO");

			let sendParm = {
				 gridParmFst : {
					 tableName		: "TBL_EXP_BRAND_GRPCODE"
					,columnMap 		: {
						 "BRAND_ID"			: { headerText : "BRAND_ID"	,hidden : "Y"										}
						,"GRP_CODE_ID"		: { headerText : "그룹ID"	,align : "left" ,width : "250px"					}
						,"GRP_CODE_NM"		: { headerText : "그룹명"	,align : "left"										}
						,"CODE_DESC"		: { headerText : "상세설명"	,align : "left"	, smallSizeHideColumn : "Y"			}
						,"USE_YN"			: { headerText : "사용여부"					, smallSizeHideColumn : "Y"			}
						,"DEL_YN"			: { headerText : "삭제여부"					, smallSizeHideColumn : "Y"			}
					 }
					,columnConfig 	: {
						 selectBoxCodeList 	: {
						 	  "USE_YN" : ynCdList
						 	 ,"DEL_YN" : ynCdList
						 }
					 }
					,primaryKeyList		: ["BRAND_ID", "GRP_CODE_ID"		]
					,searchColumnList	: ["GRP_CODE_ID","GRP_CODE_NM"		]		// Table 지정인경우 적용
					,searchWhereMap		: {"BRAND_ID" : <@pageId>.brandId }
					,orderColumnList 	: ["GRP_CODE_ID ASC"				]
					,defaultSetColumnMap: {"BRAND_ID" : <@pageId>.brandId }	// 저장할때 특정 컬럼에 기본값을 설정해야 할경우 사용
				 }
				,gridParmSnd : {
					 tableName		: "TBL_EXP_BRAND_CODE"
					,columnMap 		: {
						 "BRAND_ID"		: { headerText : "BRAND_ID"	,hidden : "Y"											}
						,"GRP_CODE_ID"	: { headerText : "그룹ID"	,hidden : "Y"											}
						,"CODE_ID" 		: { headerText : "코드ID"	,align : "left"											}
						,"CODE_NM" 		: { headerText : "코드명"	,align : "left"											}
						,"CODE_DESC"	: { headerText : "코드설명"	,align : "left"											}
						,"SORT_ORDER"	: { headerText : "순서"		,dataType : "number"									}
					 }
					,columnConfig 	: {
					 }
					,primaryKeyList		: ["BRAND_ID", "GRP_CODE_ID", "CODE_ID"]
					,searchColumnList	: ["CODE_ID","CODE_NM"		]		// Table 지정인경우 적용
					,defaultSetColumnMap: {"BRAND_ID" : <@pageId>.brandId }	
					,searchWhereMap		: {"BRAND_ID" : <@pageId>.brandId	}
					,orderColumnList 	: ["TO_CHAR(CODE_ID) ASC"			]
				 }
				,popupTitle 	: "CODE 편집"
				,fstGridTitle	: "Group Code List"
				,sndGridTitle	: "Code List"
				,connectColumn 	: ["GRP_CODE_ID"]
			}
			
			C_POP.open("popup_common_multiTableEditPopup", sendParm, function(retData){
				
			});
		 }
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function(parm) {
		<@pageId>.loadComponent();
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<page-component>
    <!-- table area start -->
	<compnent id="<@pageId>_tableGrid"></compnent>    
    <!-- table area end -->
</page-component>