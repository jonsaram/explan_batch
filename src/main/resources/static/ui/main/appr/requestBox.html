<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		 loadComponent : function(parm) {
			 
			 const yearList = [
				  ["COMPLETE", "결재완료"]
				 ,["ONGOING", "결재진행"]
				 ,["REJECT", "결재반려"]
				 ,["CANCEL", "상신취소"]
			 ]
			 
			let sendParm = {
				gridParm : {
					 requestQuery 	: {
						  queryId		: "approval.getApprovalList"
						 ,requestParm	: {holdYn : "N"}
					 }	
					,columnMap 		: {
						 "APPROVAL_ID" 		: { headerText : "APPROVAL_ID"	, hidden : "Y"	}
						,"RELATION_ID" 		: { headerText : "RELATION_ID"	, hidden : "Y"	}
						,"USER_ID" 			: { headerText : "USER_ID"		, hidden : "Y"	}
						,"USER_NM" 			: { headerText : "USER_NM"		, hidden : "Y"	}
						,"APPROVAL_DATE" 	: { headerText : "상신일" 		, dataType :'date' , dateFormat:'YYYY-MM-DD HH24:MI:SS', width : "200px"	}
						,"TITLE" 			: { headerText : "제목"			, align : "left"}
						,"STATE" 			: { headerText : "상태"			, width : "90px"}
						,"COMPLETE_DATE" 	: { headerText : "결재완료일"	, width : "200px"	}
					 }
					,rowCntId 			: "<@pageId>_rowCnt"
					,primaryKeyList		: ["APPROVAL_ID"						]
					,searchColumnList	: ["GET_USER_NM(USER_ID)",  "TITLE"		]	// Table 지정인경우 적용
					,orderColumnList 	: ["APPROVAL_DATE DESC"					]	// Table 지정인경우 적용
					,columnConfig		: {
						makeCellViewData	: {
							"STATE": function(cellText, rowData) {
								const state = rowData.STATE;
								let stateStr =  state == "COMPLETE" ? `<span class="status-complete"	>결재완료</span>` :
												state == "HOLD"     ? `<span class="status-approve"		>결재보류</span>` :
												state == "ONGOING"  ? `<span class="status-ing"			>결재진행</span>` :
												state == "REJECT"   ? `<span class="status-companion"	>결재반려</span>` :
												state == "CANCEL"   ? `<span class="status-companion"	>상신취소</span>` :
												"";

								return stateStr;
							}
						}
					}
					,rowConfig		: {
						onClickRow : function(rowData) {
							<@pageId>.apprDtlPopup(rowData.APPROVAL_ID);
						}
					 }
					,readOnly	: "Y"
				 }
				,editButtonTitle : "결재상신"
				,callbackEditButton : function(parm) {
					C_POP.open("popup_appr_approval", {size : "MAX"}, function(retData){
						if( retData.movePage == 'holdBox'){
							C_MENU.movePage('MENU1070_0200');
						}else{
							<@pageId>.loadComponent();
						}
					});
				 }
				,optionConfig		: {
					searchComponentList : [
						{
							 type			: "term"	
							,title			: "검색기간"
							,whereColumn	: "APPROVAL_DATE"
						}
						,{
							 type			: "multiSelectBox"	
							,title			: "상태"
							,whereColumn	: "STATE"
							,optionList 	: yearList
						 }						
					]
				 }
			
			}
			C_COMP.import("<@pageId>_editor", "component_compTableEditor",sendParm , function() {});		
		 }
	    ,apprDtlPopup : function(APPROVAL_ID) {    
	        C_POP.open('popup_appr_apprDtlPopup', {APPROVAL_ID : APPROVAL_ID,size : "MAX"}, function() {
	            //console.log("======= 부모창 retData =======");
	            <@pageId>.loadComponent();
	        });
	     }
	
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function(parm) {
		<@pageId>.loadComponent(parm);
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<page-component>
    <!-- table area start -->
	<compnent id="<@pageId>_editor"></compnent>    
    <!-- table area end -->
</page-component>