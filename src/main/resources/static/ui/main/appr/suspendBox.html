<meta charset="utf-8">
<script type="text/javascript">
	var <@pageId> = {
		 loadComponent : function(parm) {
			let sendParm = {
				gridParm : {
					 requestQuery 	: {
						  queryId		: "approval.getSuspenseApproval"
						 ,requestParm	: {}
					 }	
					,columnMap 		: {
						 "APPROVAL_ID" 		: { headerText : "APPROVAL_ID"	, hidden : "Y"	}
						,"RELATION_ID" 		: { headerText : "RELATION_ID"	, hidden : "Y"	}
						,"USER_ID" 			: { headerText : "USER_ID"		, hidden : "Y"	}
						,"USER_NM" 			: { headerText : "USER_NM"		, hidden : "Y"	}
						,"APPROVAL_DATE" 	: { headerText : "상신일" 		, dataType :'date' , dateFormat:'YYYY-MM-DD HH24:MI:SS'	}
						,"RSQ_USER_ID" 		: { headerText : "RSQ_USER_ID" 	, hidden : "Y"	}
						,"RSQ_USER_NM" 		: { headerText : "상신자" 		}
						,"TITLE" 			: { headerText : "제목"			}
						,"APR_USER_ID"		: { headerText : "APR_USER_ID"	, hidden : "Y"	}
						,"APR_USER_NM" 		: { headerText : "결재자"		}
						,"STATE" 			: { headerText : "상태"			}
						,"LST_APPR"			: { headerText : "마지막결재자"	, hidden : "Y"	}
						,"APPR" 			: { headerText : "결재"			, noSave : "Y", width : "110px", columnType : "button", buttonNm : "결재하기"	, buttonFn : <@pageId>.apprProcess}
					 }
					,rowCntId 			: "<@pageId>_rowCnt"
					,primaryKeyList		: ["APPROVAL_ID"							]
					,searchColumnList	: ["GET_USER_NM(USER_ID)",  "TITLE"		]	// Table 지정인경우 적용
					,orderColumnList 	: ["APPROVAL_DATE DESC"					]	// Table 지정인경우 적용
					,columnConfig		: {
						makeCellViewData	: {
							"STATE": function(cellText, rowData) {
								const state = rowData.STATE;
								let stateStr =  state == "COMPLETE" ? `<span class="status-complete"	>결재완료</span>` :
												state == "HOLD"     ? `<span class="status-approve"		>결재보류</span>` :
												state == "ONGOING"  ? `<span class="status-ing"			>결재진행</span>` :
												state == "REJECT"   ? `<span class="status-companion"	>결재반려</span>` :
												state == "CANCEL"   ? `<span class="status-companion"	>상신취소</span>` :
												"";

								return stateStr;
							}
/* 							,
							"APPR": function(cellText, rowData) {
								//return `<span class="status-companion"	>결재하기</span>`;
								return `<button class="status-companion"><a href="javascript:<@pageId>.apprProcess('${rowData}')">결재하기</a></button>`;
							} */
						}
					}
					,rowConfig		:{ 
/* 						onClickCell		: function(column) {
							if( column == "APPR"){
								<@pageId>.apprProcess(rowData)
							}else{
								<@pageId>.apprDtlPopup(rowData.APPROVAL_ID);
							}
						 } */
					}
					,readOnly	: "Y"
				 }
				,optionConfig		: {
					searchComponentList : [
						{
							 type			: "term"	
							,title			: "검색기간"
							,whereColumn	: "APPROVAL_DATE"
						}
					]
				 }
				,noEdit : "Y"
			}
			C_COMP.import("<@pageId>_editor", "component_compTableEditor",sendParm , function() {});		
		 }
	    ,apprDtlPopup : function(APPROVAL_ID) {    
	        C_POP.open('popup_appr_apprDtlPopup', {APPROVAL_ID : APPROVAL_ID,size : "MAX"}, function() {
	            //console.log("======= 부모창 retData =======");
	            <@pageId>.loadComponent();
	        });
	     }
    	,apprProcess : function(targetCell, rowData) {
    		let apprInfo = rowData;
	        C_POP.open('popup_appr_apprProcessPopup', apprInfo, function(parm) {
	        	if(parm == 'reload') {
	        		<@pageId>.loadComponent();
	        	}
	        });
    	 }
	
	}
	// Page Load가 완료된후 실행 된다.
	C_PM.onLoadPage("<@pageId>", function(parm) {
		<@pageId>.loadComponent(parm);
	});
	// History back으로 이동해왔을 경우 이루틴이 실행된다.
	C_HM.onReturn("<@pageId>", function(pageId, data) {

	});
</script>
<page-component>
    <!-- table area start -->
	<compnent id="<@pageId>_editor"></compnent>    
    <!-- table area end -->
</page-component>